

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Levels of Inference &#8212; fMRI Inference On Images</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '6.levels-inference';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Statistical Inference Using SPM" href="7.inference-spm.html" />
    <link rel="prev" title="Solutions to the Multiple Testing Problem" href="5.solutions-multiple-testing.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="fMRI Inference On Images - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="fMRI Inference On Images - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.images-to-inference.html">From Images to Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.contrasts.html">Contrasts</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.thresholding-maps.html">Thresholding Statistical Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.multiple-testing.html">The Multiple Testing Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.solutions-multiple-testing.html">Solutions to the Multiple Testing Problem</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Levels of Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.inference-spm.html">Statistical Inference Using SPM</a></li>
<li class="toctree-l1"><a class="reference internal" href="8.summary-quiz.html">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/martynmcfarquhar/NCCN-IA-fMRIInference" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/martynmcfarquhar/NCCN-IA-fMRIInference/issues/new?title=Issue%20on%20page%20%2F6.levels-inference.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/6.levels-inference.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Levels of Inference</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#features-of-an-image">Features of an Image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#voxel-level-inference">Voxel-level Inference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-level-inference">Cluster-level Inference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-a-level-of-inference">Choosing a Level of Inference</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="levels-of-inference">
<h1>Levels of Inference<a class="headerlink" href="#levels-of-inference" title="Permalink to this heading">#</a></h1>
<p>At this point, we are nearly at the end of our journey towards having some actual results. We have seen how to ask questions of our data using contrasts, create statistical maps from those contrasts and then finally threshold those maps using <span class="math notranslate nohighlight">\(p\)</span>-values corrected for multiple comparisons. At this stage, we could just stop and declare our findings based on where in the brain we see results after thresholding. However, there is one final choice we have to make in terms of our <em>level of inference</em>. This choice is based on the fact that the results at individual voxels are not necessarily the most interesting feature of an image. As such, we may want to evaluate our results using some other criteria that takes into account the <em>topology</em> of our statistical map.</p>
<section id="features-of-an-image">
<h2>Features of an Image<a class="headerlink" href="#features-of-an-image" title="Permalink to this heading">#</a></h2>
<p>Although our analysis has so far treated our image as a collection of individual datasets at each voxel, we know that in reality there are spatial connections between those voxels. So far, we have basically ignored this. However, we should really think of our images as a set of <em>topological features</em>. To see this, consider the slice through a statistical map shown in <a class="reference internal" href="#func-flat-intensity-fig"><span class="std std-numref">Fig. 18</span></a>. Looking at the image this way shows how we have a <em>landscape</em> of features, consisting of mountains and valleys of test statistics across the image.</p>
<figure class="align-default" id="func-flat-intensity-fig">
<a class="reference internal image-reference" href="_images/func-flat-intensity.png"><img alt="_images/func-flat-intensity.png" src="_images/func-flat-intensity.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 18 </span><span class="caption-text">Illustration of how a statistical map can be considered a landscape of topological features, rather than just individual tests at each voxel.</span><a class="headerlink" href="#func-flat-intensity-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>To make this a little simpler, consider the 1D slice through an image shown in <a class="reference internal" href="#image-landscape-1d-fig"><span class="std std-numref">Fig. 19</span></a>.</p>
<figure class="align-default" id="image-landscape-1d-fig">
<a class="reference internal image-reference" href="_images/image-landscape-1d.png"><img alt="_images/image-landscape-1d.png" src="_images/image-landscape-1d.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 19 </span><span class="caption-text">Illustration of a 1D slice through a test statistic image, highlighting how both the <em>peaks</em> and <em>spatial extent</em> of the test statistics may be of interest.</span><a class="headerlink" href="#image-landscape-1d-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Taking this plot into account, we can identify two types of topological feature that may be of interest. One feature is the <em>peaks</em> of the signal, corresponding to the <em>largest</em> test statistics within the image. On the left we can see a very obvious spike corresponding to a single large test statistic value. The second feature is the <em>spatial extent</em> of the signal. For instance, on the right we can see a hill of points which seems to indicate some connection between the neighbouring voxels, even if no single voxel has a particularly large test statistic value. So far in this lesson we have focused on individual voxels, which is to say we have only been looking at the <em>peaks</em> in the image. However, there is an argument to say that looking for the <em>spatial extent</em> of the signal is more meaningful. After all, how much do we trust a single voxel versus multiple voxels that appear to show a consistent effect? This distinction is an example of the final choice we have to make, namely do we focus on the largest statistics or do we focus on the spatial extent of the signal? This distinction is referred to as performing either <em>voxel-level</em> inference or <em>cluster-level</em> inference.</p>
</section>
<section id="voxel-level-inference">
<h2>Voxel-level Inference<a class="headerlink" href="#voxel-level-inference" title="Permalink to this heading">#</a></h2>
<p>The approach we have taken so far, in terms of calculating a test statistic and <span class="math notranslate nohighlight">\(p\)</span>-value at each voxel, is known as <em>voxel-level</em> inference. As illustrated in <a class="reference internal" href="#vox-level-fig"><span class="std std-numref">Fig. 20</span></a>, this involves specifying a threshold <span class="math notranslate nohighlight">\(u\)</span> and then declaring any voxel above that threshold as significant. As discussed in the last section, this threshold can be derived from uncorrected <span class="math notranslate nohighlight">\(p\)</span>-values, FWE-corrected <span class="math notranslate nohighlight">\(p\)</span>-values or FDR-corrected <span class="math notranslate nohighlight">\(p\)</span>-values.</p>
<p>The advantage of voxel-level inference is that it is the most spatially-specific approach. This is because we can point to any voxel with a significant <span class="math notranslate nohighlight">\(p\)</span>-value and say “there was a significant effect here”. This means we can <em>localise</em> effects with great accuracy. However, the disadvantage is that voxel-level inference is the more <em>conservative</em> approach. In addition, we have to think about how useful or realistic it is to find a single result at a single voxel? Surely we expect some degree of spatial extent to the signal, given that a real brain is not neatly compartmentalised into discrete voxel units. Voxel-level inference does not take this into account. As such, it is not uncommon for only a single voxel to survive correction. When this happens, we have to consider the biological plausibility of a significant change in signal only occurring within a very specific <span class="math notranslate nohighlight">\(3mm^{3}\)</span> region of the brain.</p>
<figure class="align-default" id="vox-level-fig">
<a class="reference internal image-reference" href="_images/vox-level.png"><img alt="_images/vox-level.png" src="_images/vox-level.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 20 </span><span class="caption-text">Illustration of voxel-level inference.</span><a class="headerlink" href="#vox-level-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Voxel-level inference in <code class="docutils literal notranslate"><span class="pre">SPM</span></code> is labeled as <em>peak-level</em>. The distinction between a voxel and a peak is really about the fact that a peak is a topological feature of the data, whereas a voxel is not. If this is confusing, do not worry about it. Just know that there is a distinction between voxels and peaks and that the terms are not necessarily interchangeable. If you are interested, <a class="reference external" href="https://pmc.ncbi.nlm.nih.gov/articles/PMC3221040/">Chumbley <em>et al.</em> (2010)</a> discuss this in more detail.</p>
</div>
<p>You can see an example of voxel-level-thresholded results below</p>
<iframe src="peak-level.html" width="800" height="600" frameborder="0" scrolling="no" title=""></iframe>
</section>
<section id="cluster-level-inference">
<h2>Cluster-level Inference<a class="headerlink" href="#cluster-level-inference" title="Permalink to this heading">#</a></h2>
<p>An alternative to focusing on individual voxels is to instead focus on the <em>spatial extent</em> of the signal. In order to do this, we need to first isolate the signal of interest by thresholding the image. By specifying an intial threshold (<span class="math notranslate nohighlight">\(u_c\)</span>) we create <em>clusters</em> of voxels, defined as all the voxels touching each other after thresholding. Once we have done this, we can then assess the extent of the activation by counting the number of voxels within a cluster, as illustrated in <a class="reference internal" href="#clust-level-fig"><span class="std std-numref">Fig. 21</span></a>.</p>
<figure class="align-default" id="clust-level-fig">
<a class="reference internal image-reference" href="_images/clust-level.png"><img alt="_images/clust-level.png" src="_images/clust-level.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 21 </span><span class="caption-text">Illustration of cluster-level inference.</span><a class="headerlink" href="#clust-level-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>How do we use this information for inference? In brief, the machinery of random-field theory can be tuned to give us information on the size of clusters we would expect under the null hypothesis. Because of this, we can calculate <span class="math notranslate nohighlight">\(p\)</span>-values for the <em>size</em> of a cluster, allowing us to ask what the probability is of a cluster <em>this large or larger</em>, if the null hypothesis were true. This gives an uncorrected <span class="math notranslate nohighlight">\(p\)</span>-value, which can be subsequently corrected using the expected number of clusters to produce a <span class="math notranslate nohighlight">\(p_{\text{FWE}}\)</span> value, or using an FDR procedure to produce a <span class="math notranslate nohighlight">\(q_{\text{FDR}}\)</span> value. So, much like voxel-level inference, we can calculate <span class="math notranslate nohighlight">\(p\)</span>-values for clusters and then correct them across the brain.</p>
<p>Based on this description, it should be clear that cluster-level inference is a <em>two-step</em> procedure. First, we specify an initial threshold to create the clusters, then we perform inference using corrected <span class="math notranslate nohighlight">\(p\)</span>-values on the resultant clusters. This initial threshold is commonly known as the <em>cluster-forming threshold</em>, and is typically specified as an uncorrected <span class="math notranslate nohighlight">\(p &lt; 0.001\)</span>. This threshold is essentially <em>arbitrary</em> and is there simply to create clusters. This threshold will determine the size of clusters you get, as the more liberal it is the bigger the clusters will become. In principle, this should not matter because the FWE correction takes account of this by knowing the size of cluster we would expect under the null at that threshold. However, if you make the threshold too liberal, you may find that individual clusters merge into single large clusters that are difficult to interpret. Also, evidence from Eklund, Nichols &amp; Knutsson (2016) suggests that with a threshold more liberal than <span class="math notranslate nohighlight">\(p &lt; 0.001\)</span>, the assumptions of random field theory break-down and the FWE procedure becomes shockingly liberal. All this is to say that you should probably just stick to <span class="math notranslate nohighlight">\(p &lt; 0.001\)</span> as the cluster-forming threshold.</p>
<p>An addition issue with the cluster-level is that, although more sensitive than voxel-level inference, this sensitivity comes at the cost of our ability to spatially localise effects. Whereas with voxel-level inference we can identify individual voxels as significant, we cannot do that with clusters because a significant cluster is based purely on the <em>size</em> and not the signal within the cluster. All you can really conclude is that one or more voxels in the cluster has evidence against the null. Although tempting to look at the peak statistic within a cluster, this will not always be helpful. If the cluster is very large then the peak may not be very representative of the whole cluster. For instance, there may be a variety of effects within a cluster that lead to <span class="math notranslate nohighlight">\(p &lt; 0.001\)</span>. We therefore cannot always assume that the effect at the peak will be the same everywhere in the cluster. In addition, just focusing on the peak will not necessarily help with localising effects if the cluster covers half the brain (for instance). So we lose our ability to localise results very accurately, but do gain more sensitivity.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Clusters are based on voxels touching each other after thresholding. Note that different software uses different definition of “touching”. For instance, we could count touching as including only the <em>faces</em> and <em>edges</em> of voxels, or we could also include voxels where the <em>corners</em> touch. <code class="docutils literal notranslate"><span class="pre">SPM</span></code> uses an 18-connectivity scheme, which includes all faces (6) and all edges (12), but does not include corners.</p>
</div>
<p>You can see an example of cluster-level-thresholded results below</p>
<iframe src="cluster-level.html" width="800" height="600" frameborder="0" scrolling="no" title=""></iframe>
</section>
<section id="choosing-a-level-of-inference">
<h2>Choosing a Level of Inference<a class="headerlink" href="#choosing-a-level-of-inference" title="Permalink to this heading">#</a></h2>
<p>Choosing between voxel-level and cluster-level is a balance between sensitivity and localising power. Voxel-level is less sensitive, but better at localisation, whereas cluster-level is more sensitive, but worse at localisation. Cluster-level also requires the arbitrary cluster-forming threshold, which can be cause for criticism given that there is no objective way to determine what this should be. We can see these difference by considering the results presented above. While there are many more results with cluster-level, the size of some of the clusters makes it difficult to localise exactly which regions of the brain are associated with the task. As such, we cannot point to any single voxel and say “there was a significant effect here”. All we can really say is that there was enough consistent activity across a range of voxels to be surprising if there was no effect present. Although there are many fewer results with voxel-level, we do at least have the ability to point to a single location and say that there was an effect <em>precisely</em> here. Although most of these results have clustered in a convincing way, there are some locations where only a small number of voxels survives. Is this convincing? If not, how many voxels would you need for the results to be convincing? There is no answer to this, making it an entirely arbitrary choice. As such, we need to accept that, technically, a single voxel is just as legitimate a finding as a cluster of 100 voxels. But would you want to stake the main findings of your paper on only 1 voxel?</p>
<p>So, choosing between these two approach is tricky. Some software (such as <code class="docutils literal notranslate"><span class="pre">FSL</span></code>) defaults to cluster-level by arguing for increased sensitivity, but <code class="docutils literal notranslate"><span class="pre">SPM</span></code> does not do this. Instead, <code class="docutils literal notranslate"><span class="pre">SPM</span></code> shows you <em>all</em> levels of inference at once. You choose an initial feature-defining threshold and then <code class="docutils literal notranslate"><span class="pre">SPM</span></code> will show the cluster-level and peak-level results for that threshold. A typical approach is then to choose uncorrected <span class="math notranslate nohighlight">\(p &lt; 0.001\)</span> as the initial threshold and then look at both voxel-level and cluster-level statistics together. This threshold will create clusters and peaks for all the correction techniques that need them, but will not affect those correction techniques that do not. This means you can look at both cluster and voxel results in the results table, as shown in <a class="reference internal" href="#spm-table-fig"><span class="std std-numref">Fig. 22</span></a>. The advantage of this is that you can see what would happen if you used different levels of inference. The disadvantage is that the temptation is just to choose whichever one gives you results closest to the results you want. What you should be doing is choosing your level of inference <em>before</em> even analysing the data, based on the aims of your experiment.</p>
<figure class="align-default" id="spm-table-fig">
<a class="reference internal image-reference" href="_images/spm-table.png"><img alt="_images/spm-table.png" src="_images/spm-table.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 22 </span><span class="caption-text">Example of a results table from <code class="docutils literal notranslate"><span class="pre">SPM</span></code>.</span><a class="headerlink" href="#spm-table-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">SPM</span></code> also includes <em>set-level</em> inference, which uses GRF to determine the probability of the number of clusters in the results, under the null. For instance, <a class="reference internal" href="#spm-table-fig"><span class="std std-numref">Fig. 22</span></a> shows set-level inference for the 5 clusters that remain after thresholding. As this is significant, we could conclude that a significant number of clusters were found. However, given that there is no interesting spatial information in this level of inference, it is debatable how useful this is.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You should <em>not</em> mix-and-match the cluster and voxel level, because they are asking two different questions about your data. The voxel-level is asking “is the effect at this voxel surprising if the null hypothesis were true” whereas the cluster-level is asking “is the size of this cluster at this cluster-defining threshold surprising if the null hypothesis were true”. So you need to pick one to stick with for all your results, rather than picking whichever one makes your results look nicer on an ad-hoc basis. Much like choosing a correction technique, this lack of certainty on which level of inference to choose may feel unsatisfactory. Unfortunately, there is not single correct approach here, so we reach a point where we have to make a decision for ourselves about which one to go with. <code class="docutils literal notranslate"><span class="pre">SPM</span></code> can provide us with options, but ultimately the decision is ours.</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "jupyter_matlab_kernel"
        },
        kernelOptions: {
            name: "jupyter_matlab_kernel",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'jupyter_matlab_kernel'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="5.solutions-multiple-testing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Solutions to the Multiple Testing Problem</p>
      </div>
    </a>
    <a class="right-next"
       href="7.inference-spm.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Statistical Inference Using SPM</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#features-of-an-image">Features of an Image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#voxel-level-inference">Voxel-level Inference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-level-inference">Cluster-level Inference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-a-level-of-inference">Choosing a Level of Inference</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Martyn McFarquhar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>